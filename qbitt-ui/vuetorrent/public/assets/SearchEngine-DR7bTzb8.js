import{h as X,E as Z,f as y,H as v,I as w,J as l,n as e,W as $,L as g,K as k,Y as M,q as se,u as p,M as H,P as oe,$ as re,c as F,G as ue,v as ce,S as de,F as fe,Z as me,O as ge}from"./vue-CMGd_gjG.js";import{a as pe,S as x,V as O,c as ve,h as I,i as c,k as B,j as G,d as Q,e as he,f as ee,g as W,T as le,A as ye,l as ke,m as Ve,G as be,I as Ee,s as P,C as Se,t as S,o as we,U as Ce,W as $e,D as Y,v as _e,H as Te,w as J,E as Pe,X as Ie,__tla as __tla_0}from"./index-BWnwvcbv.js";import"./vuetify-DtNd5Sc7.js";let Ae;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})()]).then(async()=>{let Me,Ne,De,Ue,qe,Le,Re;Me={key:1};Ne={key:1};De=["href","title"];Ue=X({__name:"PluginManagerDialog",props:{guid:{}},setup(z){const N=z,{isOpened:t}=pe(N.guid),{t:V}=Z(),d=x(),f=[{title:V("dialogs.pluginManager.headers.enabled"),key:"enabled",sortable:!1},{title:V("dialogs.pluginManager.headers.name"),key:"fullName"},{title:V("dialogs.pluginManager.headers.version"),key:"version"},{title:V("dialogs.pluginManager.headers.url"),key:"url"},{title:V("dialogs.pluginManager.headers.actions"),key:"actions"}],b=y(!1),E=y(!1),C=y(!1),h=y(!1),u=y("");async function D(n){await d.toggleSearchPlugin(n),await d.fetchSearchPlugins()}async function _(){E.value=!0,await d.updatePlugins().then(()=>new Promise(n=>setTimeout(n,2e3))),await d.fetchSearchPlugins(),E.value=!1}async function U(){T(),b.value=!0,await d.installSearchPlugin(u.value),u.value="",setTimeout(()=>{d.fetchSearchPlugins().then(()=>{b.value=!1})},1e3)}async function q(n){b.value=!0,await d.uninstallSearchPlugin(n.name),await d.fetchSearchPlugins(),b.value=!1}const o=()=>{t.value=!1};function T(){C.value=!1}return(n,m)=>(v(),w(G,{modelValue:p(t),"onUpdate:modelValue":m[4]||(m[4]=i=>oe(t)?t.value=i:null)},{default:l(()=>[e(O,null,{default:l(()=>[e(ve,{class:"d-flex"},{default:l(()=>[$("div",null,g(n.$t("dialogs.pluginManager.title")),1),e(I),e(c,{icon:n.$vuetify.display.mobile,color:"accent",class:"mr-2",loading:E.value,onClick:_},{default:l(()=>[n.$vuetify.display.mobile?(v(),w(B,{key:0},{default:l(()=>[k("mdi-update")]),_:1})):(v(),M("span",Me,g(n.$t("dialogs.pluginManager.update")),1))]),_:1},8,["icon","loading"]),e(G,{modelValue:C.value,"onUpdate:modelValue":m[3]||(m[3]=i=>C.value=i)},{activator:l(({props:i})=>[e(c,se(i,{icon:n.$vuetify.display.mobile,color:"primary"}),{default:l(()=>[n.$vuetify.display.mobile?(v(),w(B,{key:0},{default:l(()=>[k("mdi-toy-brick-plus")]),_:1})):(v(),M("span",Ne,g(n.$t("dialogs.pluginManager.install.activator")),1))]),_:2},1040,["icon"])]),default:l(()=>[e(O,{title:n.$t("dialogs.pluginManager.install.title")},{default:l(()=>[e(Q,null,{default:l(()=>[e(p(he),{modelValue:h.value,"onUpdate:modelValue":m[1]||(m[1]=i=>h.value=i),onSubmit:m[2]||(m[2]=H(()=>{},["prevent"]))},{default:l(()=>[e(ee,{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=i=>u.value=i),autofocus:"",label:n.$t("dialogs.pluginManager.install.label")},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(W,null,{default:l(()=>[e(I),e(c,{color:"error",onClick:T},{default:l(()=>[k(g(n.$t("common.cancel")),1)]),_:1}),e(c,{color:"accent",onClick:U},{default:l(()=>[k(g(n.$t("common.ok")),1)]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),e(Q,null,{default:l(()=>[e(le,{mobile:null,headers:f,"items-per-page":"-1",items:p(d).searchPlugins,"sort-by":[{key:"fullName",order:"asc"}],loading:b.value},{"item.enabled":l(({item:i})=>[e(ye,{"model-value":i.enabled,onClick:L=>D(i)},null,8,["model-value","onClick"])]),"item.url":l(({item:i})=>[$("a",{href:i.url,title:i.name},g(i.url),9,De)]),"item.actions":l(({item:i})=>[e(B,{color:"red",icon:"mdi-delete",onClick:L=>q(i)},null,8,["onClick"])]),_:2},1032,["items","loading"])]),_:1}),e(W,null,{default:l(()=>[e(I),e(c,{color:"accent",onClick:o},{default:l(()=>[k(g(n.$t("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});qe={class:"pa-3"};Le={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"};Re={class:"d-flex justify-end"};Ae=X({__name:"SearchEngine",setup(z){const N=de(),{t}=Z(),V=ke(),d=Ve(),f=x(),b=be(),E=y(),C=y(!1),h=y(0),{searchData:u}=re(f),D=[{title:t("searchEngine.headers.fileName"),key:"fileName"},{title:t("searchEngine.headers.fileSize"),key:"fileSize"},{title:t("searchEngine.headers.nbSeeders"),key:"nbSeeders"},{title:t("searchEngine.headers.nbLeechers"),key:"nbLeechers"},{title:t("searchEngine.headers.siteUrl"),key:"siteUrl"},{title:"",key:"actions",sortable:!1}],_=[{title:t("searchEngine.filters.category.movies"),value:"movies"},{title:t("searchEngine.filters.category.tv"),value:"tv"},{title:t("searchEngine.filters.category.music"),value:"music"},{title:t("searchEngine.filters.category.games"),value:"games"},{title:t("searchEngine.filters.category.anime"),value:"anime"},{title:t("searchEngine.filters.category.software"),value:"software"},{title:t("searchEngine.filters.category.pictures"),value:"pictures"},{title:t("searchEngine.filters.category.books"),value:"books"}];_.sort((a,r)=>a.title.localeCompare(r.title));const U=[{title:t("searchEngine.filters.category.all"),value:"all"},..._],q=F(()=>{const a=[{title:t("searchEngine.filters.plugins.all"),value:"all"},{title:t("searchEngine.filters.plugins.enabled"),value:"enabled"}];return f.searchPlugins.filter(r=>r.enabled).forEach(r=>{a.push({title:r.name,value:r.name})}),a}),o=F(()=>u.value[h.value]??{}),{results:T}=Ee(()=>o.value.results,()=>o.value.filters?.title,a=>a.fileName);function n(){f.createNewTab(),h.value=u.value.length-1,E.value?.focus()}function m(){u.value.length!==1&&(f.deleteTab(o.value.uniqueId),h.value=Math.min(h.value,u.value.length-1))}function i(a){V.pushTorrentToQueue(a.fileUrl)}function L(a){window.open(a.descrLink,"_blank","noreferrer")}async function A(){await f.runNewSearch(o.value),o.value.timer=setInterval(()=>te(o.value),1e3),E.value?.saveValueToHistory()}async function R(a){await f.stopSearch(a),a.timer&&clearInterval(a.timer)}function ae(){u.value.forEach(R)}async function te(a){await f.refreshResults(a)==="Stopped"&&await R(a)}const K=()=>{N.push({name:"dashboard"})};function ne(){d.createDialog(Ue)}function j(a){if(d.hasActiveDialog||C.value)return!1;a.key==="Escape"&&K()}return ue(async()=>{document.addEventListener("keydown",j),u.value.length===0?f.createNewTab():u.value.forEach(a=>{a.id&&a.id!==0&&(a.timer=setInterval(()=>f.refreshResults(a),1e3))}),await f.fetchSearchPlugins()}),ce(()=>{document.removeEventListener("keydown",j),u.value.forEach(a=>{a.timer&&clearInterval(a.timer)})}),(a,r)=>(v(),M("div",qe,[e(P,{"no-gutters":"",align:"center",justify:"center"},{default:l(()=>[e(S,null,{default:l(()=>[$("h1",Le,g(p(t)("searchEngine.title")),1)]),_:1}),e(S,null,{default:l(()=>[$("div",Re,[e(c,{icon:"mdi-stop",variant:"plain",color:"error",onClick:ae}),e(c,{icon:"mdi-toy-brick",variant:"plain",color:"primary",onClick:ne}),e(c,{icon:"mdi-close",variant:"plain",onClick:K})])]),_:1})]),_:1}),e(P,{class:"ma-0 pa-0"},{default:l(()=>[e(we,{class:"d-flex align-center justify-center ma-0 pa-0 bg-primary",fluid:""},{default:l(()=>[e(Ce,{modelValue:h.value,"onUpdate:modelValue":r[0]||(r[0]=s=>h.value=s),class:"overflow-auto","bg-color":"primary","show-arrows":""},{default:l(()=>[(v(!0),M(fe,null,me(p(u),s=>(v(),w($e,{key:s.uniqueId},{default:l(()=>[$("h4",null,g(!s.query||s.query.length===0?a.$t("searchEngine.tabHeaderEmpty"):s.query),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]),e(I),e(c,{icon:"mdi-plus-circle-outline",variant:"plain",color:"accent",onClick:n}),e(c,{icon:"mdi-minus-circle-outline",variant:"plain",color:"error",disabled:p(u).length===1,onClick:m},null,8,["disabled"])]),_:1})]),_:1}),e(Se,null,{default:l(()=>[e(Y,null,{default:l(()=>[e(P,{class:"mt-1"},{default:l(()=>[e(S,{cols:"12",md:"6"},{default:l(()=>[e(_e,{modelValue:o.value.query,"onUpdate:modelValue":r[1]||(r[1]=s=>o.value.query=s),"history-key":p(Te).SEARCH_ENGINE_QUERY,ref_key:"queryInput",ref:E,autofocus:"",density:"compact","hide-details":"",clearable:"",label:a.$t("searchEngine.query"),onKeydown:ge(H(A,["prevent"]),["enter"])},null,8,["modelValue","history-key","label","onKeydown"])]),_:1}),e(S,{cols:"6",sm:"5",md:"2"},{default:l(()=>[e(J,{modelValue:o.value.filters.category,"onUpdate:modelValue":r[2]||(r[2]=s=>o.value.filters.category=s),height:"1",variant:"outlined",density:"compact","hide-details":"",items:U,label:a.$t("searchEngine.filters.category.label")},null,8,["modelValue","label"])]),_:1}),e(S,{cols:"6",sm:"5",md:"2"},{default:l(()=>[e(J,{modelValue:o.value.filters.plugin,"onUpdate:modelValue":r[3]||(r[3]=s=>o.value.filters.plugin=s),flat:"",density:"compact","hide-details":"",variant:"outlined",items:q.value,label:a.$t("searchEngine.filters.plugins.label")},null,8,["modelValue","items","label"])]),_:1}),e(S,{cols:"12",sm:"2",class:"d-flex align-center justify-center"},{default:l(()=>[o.value.id===0?(v(),w(c,{key:0,color:"accent",flat:"",class:"mx-auto px-4",onClick:A},{default:l(()=>[k(g(a.$t("searchEngine.runSearch")),1)]),_:1})):(v(),w(c,{key:1,color:"warning",flat:"",class:"mx-auto px-4",onClick:r[4]||(r[4]=s=>R(o.value))},{default:l(()=>[k(g(a.$t("searchEngine.stopSearch")),1)]),_:1}))]),_:1})]),_:1})]),_:1}),e(Pe,{class:"my-3"}),e(Y,{class:"text-select"},{default:l(()=>[e(le,{mobile:null,headers:D,items:p(T),"footer-props":{itemsPerPageOptions:[10,25,50,100,-1]},"items-per-page":o.value.itemsPerPage},{top:l(()=>[e(P,null,{default:l(()=>[e(S,{cols:"12"},{default:l(()=>[e(ee,{modelValue:o.value.filters.title,"onUpdate:modelValue":r[5]||(r[5]=s=>o.value.filters.title=s),density:"compact","hide-details":"",label:a.$t("searchEngine.filters.title.label")},null,8,["modelValue","label"])]),_:1})]),_:1})]),"item.fileSize":l(({item:s})=>[k(g(p(Ie)(s.fileSize,p(b).useBinarySize)),1)]),"item.actions":l(({item:s})=>[e(c,{icon:"mdi-open-in-new",variant:"flat",density:"compact",onClick:H(ie=>L(s),["stop"])},null,8,["onClick"]),e(c,{icon:"mdi-download",variant:"flat",density:"compact",onClick:ie=>i(s)},null,8,["onClick"])]),_:2},1032,["items","items-per-page"])]),_:1})]),_:1})]))}})});export{Ae as default,__tla};